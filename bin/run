#!/bin/sh
RUNLIBS="mgcore cppsqlite3 datacopy gprs"
arch=arm   #x86 arm armv5te
exportpath=
cat /proc/cpuinfo | grep "ARM926EJ-S"
if [ $? == 0 ];then
	echo "arm platform"
	arch=arm
else
	arch=x86
	echo "x86 platform"
    
fi
for item in $RUNLIBS
do
	exportpath=$exportpath:../$item/lib/$arch:../../gui/mg1.6/out/$arch/lib
	#echo $exportpath
done
export LD_LIBRARY_PATH=$exportpath:/usr/local/lib:../lib
if [ -e reset.txt ];then
	rm reset.txt 
fi
if [ -e /sys/bus/i2c/devices/1-0020/direction0 ];then
	echo 0 > /sys/bus/i2c/devices/1-0020/output0 
	echo 0 > /sys/bus/i2c/devices/1-0020/output1 
	echo 0 > /sys/bus/i2c/devices/1-0020/direction0 
	echo 0 > /sys/bus/i2c/devices/1-0020/direction1 
fi
./gprs-demon &
while :
do
echo start `date` >> reset.txt
./ctx2000
echo end `date` >> reset.txt
sleep 2
done
